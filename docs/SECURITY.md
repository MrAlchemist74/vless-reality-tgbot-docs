# Безопасность

## Основные принципы
- **Секреты вне репозитория.** UUID, PBK, SID, токен бота — только env/Secret Manager. В git — лишь `.env.example`.
- **Логи без секретов.** Не логировать `UUID/PBK/SID` и **не** писать в одной записи коррелируемые `FP/SNI/PORT`.
- **Сетевые правила.** Открыт только нужный порт; SSH по ключам; опционально fail2ban/ufw.
- **Актуальность.** Регулярные патчи ОС и Xray; пин версий (совместимость клиентов v2rayN и т.д.).

## Docker/Compose hardening (минимум)
- Запуск от непривилегированного пользователя (`user: 1000:1000`), `read_only: true`, `no-new-privileges: true`.
- `cap_drop: [ALL]`, ограниченные тома, без `hostNetwork`.
- Пин образов по digest, политика рестартов, ограничение ресурсов (CPU/Memory).
- Отдельная пользовательская сеть для связки бот↔xray.

## Угрозы и меры
- **Перехват/анализ трафика** → Reality/SNI-декой, актуальные шифры, e2e-чек вместо TCP-connect.
- **Подбор/утечка реквизитов** → ограничение распространения, ротация ключей, мониторинг необычной активности.
- **Компрометация VPS** → минимизация открытых сервисов, доступ по ключам, обновления, мониторинг.

## Политика инцидентов безопасности
- Немедленная ротация секретов; аудит последних действий; краткий отчёт; корректирующие меры в Roadmap.

